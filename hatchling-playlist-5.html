<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <title></title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.css">
    <style>
        .audioPlayer {
            display: block;
            border-radius: 20px;
            margin:0 0;
        }
        .audioPlayer-label {
            display: block;
            margin:0 0;
            font-size: 20px;
            /* text-align: center;        */
        }
        .playListItem:before {
            content: "\f04b  ";
            font: 0.85em "FontAwesome";
        }            
        .playListItem .selected:before {
            content: "\f04c  ";
            font: 0.85em "FontAwesome";
        }            
        .playListItem {
            padding: 10 10;
        } 
        .playListItem:hover {
            background-color: azure;
        } 
        #playlist { 
            list-style: none;
            margin: auto;

        }
        .border {
            border: 2px solid red;
        }
          
    </style>
</head>

<body>
<div class="audioPlayer-label" id="now-playing"> Select Song Below </div>
<audio class="audioPlayer" id="player" controls>
    <source src="https://archive.org/download/calexico2006-12-02..flac16/calexico2006-12-02d1t02.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
</audio>
<ul id="playlist"></ul>
<button id="stop">Play/Pause</button>
<button id="next" onclick="playNext()">Next</button>
<button id="previous" onclick="playPrevious()">Previous</button>

<script>
    const _player = document.getElementById("player");
    const _playlist = document.getElementById("playlist");
    const _stop = document.getElementById("stop");
    const _label = document.getElementById("now-playing");
    // const BASE_SONG_URL = 'https://github.com/rdhenderson/hatchling-songs/blob/main'
    const BASE_SONG_URL = 'https://github.com/rdhenderson/hatchling-songs/raw/refs/heads/main'

    const songList = [
            { title: 'Ye Toop Daram', url: 'ye_toop_daram.mp3' },
            { title: "Que Bueno A Verte / I'm Happy To See You", url: 'que_bueno_a_verte_im_happy_to_see_you.mp3' },
            { title: 'Ti Si Mi', url: 'ti_si_mi.mp3' },
            { title: 'Al Tambor C', url: 'al_tambor_c.mp3' },
            { title: 'Ha Ha This Away For Ukulele', url: 'ha_ha_this_away_for_ukulele.mp3' },
            { title: 'I Say Goodbye', url: 'i_say_goodbye.mp3' },
            { title: 'Lets Get Our Music On', url: 'lets_get_our_music_on.mp3' },
            { title: 'Looby Loo in C', url: 'looby_loo_in_c.mp3' },
            { title: 'Pennsylvania Dreamin', url: 'pennsylvania_dreamin.mp3' },
            { title: 'Survivor Instrumental Key of D minor', url: 'survivor_instrumental_key_of_d_minor.mp3' },
            { title: 'Whatd You Do In Music 2.0', url: 'whatd_you_do_in_music_2.0.mp3' },
        ];
    songList.forEach(song => addSongToPlaylist(song.title, `${BASE_SONG_URL}/${song.url}`))
    // functions
    function addSongToPlaylist(title, source) {
            var ul = document.getElementById("playlist");
            var li = document.createElement("li");
            li.classList.add("playListItem");
            // li.appendChild(document.createTextNode(title));
            const icon = document.createElement("i");
            icon.className = "fa-solid fa-download";
            const link = document.createElement("a");
            link.href = source;
            link.download = source.split('/').pop();
            link.appendChild(icon);
            li.innerText = `${title}`;
            // li.innerText = `${icon} ${file}`;
            li.setAttribute("data-src", source); // added line
            ul.appendChild(li);
        }
    function playlistItemClick(clickedElement) {
        const selected = _playlist.querySelector(".selected");
        if (selected) {
            selected.classList.remove("selected");
        }
        clickedElement.classList.add("selected");

        _player.src = clickedElement.getAttribute("data-src");
        _label.innerHTML = `Now Playing: ${clickedElement.innerHTML}`;
        _player.play();
    }

    function playNext() {
        var selected = _playlist.querySelector("li.selected");
        if (selected) {
            console.log(selected)
            if (selected.nextElementSibling) {
                playlistItemClick(selected.nextElementSibling);
            } else if (selected.firstElementSibling) {
                playlistItemClick(selected.firstElementSibling);
            }
        }
    }
    function playPrevious() {
        var selected = _playlist.querySelector("li.selected");
        if (selected && selected.previousElementSibling) {
            playlistItemClick(selected.previousElementSibling);
        }
    }

    // event listeners
    _stop.addEventListener("click", function () {
        console.log("Clicked stop")
        if (_player.paused) {
            _player.play();
        } else {
            _player.pause();
        }
    });

    _player.addEventListener("ended", playNext);
    _playlist.addEventListener("click", function (e) {
        if (e.target && e.target.nodeName === "LI") {
            playlistItemClick(e.target);
        }
    });

</script>
</body>

</html>
